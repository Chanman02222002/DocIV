{% extends "base.html" %}
{% block title %}Call Details â€“ DocIV{% endblock %}

{% block content %}
<h2 class="mb-3">Call Details</h2>

<div class="card mb-4">
  <div class="card-body">
    <p><strong>Date / Time:</strong> {{ call.datetime.strftime("%Y-%m-%d %H:%M") }}</p>
    <p><strong>Client:</strong> {{ call.client.name if call.client else "N/A" }}</p>
    <p><strong>Status:</strong>
      {% if call.canceled %}
        <span class="badge bg-danger">Canceled</span>
      {% elif call.reschedule_requested %}
        <span class="badge bg-warning text-dark">Reschedule requested</span>
      {% else %}
        <span class="badge bg-success">Scheduled</span>
      {% endif %}
    </p>
    {% if call.reschedule_requested and call.reschedule_datetime %}
      <p><strong>Requested new time:</strong>
        {{ call.reschedule_datetime.strftime("%Y-%m-%d %H:%M") }}
      </p>
      {% if call.reschedule_note %}
        <p><strong>Note:</strong> {{ call.reschedule_note }}</p>
      {% endif %}
    {% endif %}
  </div>
</div>

<form method="post" class="row g-3">
  <div class="col-12">
    <label class="form-label">If requesting reschedule, choose new date/time:</label>
    <input type="datetime-local" name="reschedule_datetime" class="form-control">
  </div>
  <div class="col-12">
    <label class="form-label">Optional note</label>
    <textarea name="reschedule_note" class="form-control" rows="3"></textarea>
  </div>
  <div class="col-12 d-flex gap-2">
    <button type="submit" name="action" value="cancel" class="btn btn-outline-danger">
      Cancel Meeting
    </button>
    <button type="submit" name="action" value="reschedule" class="btn btn-primary">
      Request Reschedule
    </button>
    <a href="{{ url_for('doctor_dashboard') }}" class="btn btn-secondary ms-auto">
      Back
    </a>
  </div>
</form>
{% endblock %}
